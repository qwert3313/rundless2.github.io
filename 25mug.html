<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Glossy Mug</title>
    <link rel="stylesheet" href="items.css">
    <script src="https://cdn.snipcart.com/themes/v3.4.0/default/snipcart.js"></script>
    <link rel="stylesheet" href="https://cdn.snipcart.com/themes/v3.4.0/default/snipcart.css" />
</head>

<body>
            <script>
        window.SnipcartSettings = {
            publicApiKey: "MjhjYTAzOTktMTgwNC00ZDdhLWJmNmYtOGRjOWVmMDAwNTE2NjM4NzAwNDk3MDU3MzI5MzE0",
            loadStrategy: "on-user-interaction",
        };

        (function () { var c, d; (d = (c = window.SnipcartSettings).version) != null || (c.version = "3.0"); var s, S; (S = (s = window.SnipcartSettings).timeoutDuration) != null || (s.timeoutDuration = 2750); var l, p; (p = (l = window.SnipcartSettings).domain) != null || (l.domain = "cdn.snipcart.com"); var w, u; (u = (w = window.SnipcartSettings).protocol) != null || (w.protocol = "https"); var m, g; (g = (m = window.SnipcartSettings).loadCSS) != null || (m.loadCSS = !0); var y = window.SnipcartSettings.version.includes("v3.0.0-ci") || window.SnipcartSettings.version != "3.0" && window.SnipcartSettings.version.localeCompare("3.4.0", void 0, { numeric: !0, sensitivity: "base" }) === -1, f = ["focus", "mouseover", "touchmove", "scroll", "keydown"]; window.LoadSnipcart = o; document.readyState === "loading" ? document.addEventListener("DOMContentLoaded", r) : r(); function r() { window.SnipcartSettings.loadStrategy ? window.SnipcartSettings.loadStrategy === "on-user-interaction" && (f.forEach(function (t) { return document.addEventListener(t, o) }), setTimeout(o, window.SnipcartSettings.timeoutDuration)) : o() } var a = !1; function o() { if (a) return; a = !0; let t = document.getElementsByTagName("head")[0], n = document.querySelector("#snipcart"), i = document.querySelector('src[src^="'.concat(window.SnipcartSettings.protocol, "://").concat(window.SnipcartSettings.domain, '"][src$="snipcart.js"]')), e = document.querySelector('link[href^="'.concat(window.SnipcartSettings.protocol, "://").concat(window.SnipcartSettings.domain, '"][href$="snipcart.css"]')); n || (n = document.createElement("div"), n.id = "snipcart", n.setAttribute("hidden", "true"), document.body.appendChild(n)), h(n), i || (i = document.createElement("script"), i.src = "".concat(window.SnipcartSettings.protocol, "://").concat(window.SnipcartSettings.domain, "/themes/v").concat(window.SnipcartSettings.version, "/default/snipcart.js"), i.async = !0, t.appendChild(i)), !e && window.SnipcartSettings.loadCSS && (e = document.createElement("link"), e.rel = "stylesheet", e.type = "text/css", e.href = "".concat(window.SnipcartSettings.protocol, "://").concat(window.SnipcartSettings.domain, "/themes/v").concat(window.SnipcartSettings.version, "/default/snipcart.css"), t.prepend(e)), f.forEach(function (v) { return document.removeEventListener(v, o) }) } function h(t) { !y || (t.dataset.apiKey = window.SnipcartSettings.publicApiKey, window.SnipcartSettings.addProductBehavior && (t.dataset.configAddProductBehavior = window.SnipcartSettings.addProductBehavior), window.SnipcartSettings.modalStyle && (t.dataset.configModalStyle = window.SnipcartSettings.modalStyle), window.SnipcartSettings.currency && (t.dataset.currency = window.SnipcartSettings.currency), window.SnipcartSettings.templatesUrl && (t.dataset.templatesUrl = window.SnipcartSettings.templatesUrl)) } })();
    </script>
        <button class="snipcart-checkout"
        style="background-color: transparent; border: none; position: absolute; top: 20px; right: 50px; width: 5%; height: 5%; cursor: pointer;">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
            <path
                d="M351.9 329.506H206.81l-3.072-12.56H368.16l26.63-116.019-217.23-26.04-9.952-58.09h-50.4v21.946h31.894l35.233 191.246a32.927 32.927 0 1 0 36.363 21.462h100.244a32.825 32.825 0 1 0 30.957-21.945zM181.427 197.45l186.51 22.358-17.258 75.195H198.917z"
                data-name="Shopping Cart" />
        </svg>
        <nobr><span class="snipcart-total-price"></span>
            (<span class="snipcart-items-count"></span>)
    </button></nobr>
    <div class="container">
        <!-- Linke Spalte: Slideshow -->
        <div class="image-container">
            <h1>Glossy Mug</h1>
            <div class="slideshow" id="slideshow-black" style="display: block;">
                <img src="img/mug/black-glossy-mug-black-11-oz-handle-on-left-6763c5465a6c4.jpg" alt="Black Product 1"
                    class="active">
                <img src="img/mug/black-glossy-mug-black-11-oz-front-6763c5465a7c4.jpg" alt="Black Product 2">
                <img src="img/mug/black-glossy-mug-black-11-oz-handle-on-right-6763c5465a831.jpg" alt="Black Product 3">
                <div class="controls">
                    <button class="prev" onclick="changeSlide(-1)">❮ Previous</button>
                    <button class="next" onclick="changeSlide(1)">Next ❯</button>
                </div>
            </div>
        </div>

        <!-- Rechte Spalte: Inhalt -->
        <div class="content-container">
            <p>Lorem ipsum dolor sit amet consectetur, adipisicing elit. Laudantium earum doloribus possimus in qui
                distinctio accusantium, tempore sunt sed consequatur molestias cupiditate illo sequi commodi numquam
                porro
                assumenda velit ullam.
            </p>
            <select id="color-select" style="display: none;">
                <option value="black" selected>Black</option>
            </select>
                        <form action="https://gamebackend-nfw1.onrender.com/check" method="post" id="code-form">
                <button id="button" type="button" onclick="changeType()" class="button">View</button>
                <input type="password" id="inputField" name="code" placeholder="Enter your Code" required>
                <button class="button" type="submit">CHECK CODE</button>
            </form>
            <p><strong style="font-size: larger;"><s>16$</s>12$</strong></p>
            <button class="snipcart-add-item button" style="display: none;" data-item-id="4657797417" data-item-price="12.00"
                data-item-description="A blag, glossy mug you can fill drinks in"
                data-item-image="img/mug/black-glossy-mug-black-11-oz-handle-on-left-6763c5465a6c4.jpg"
                data-item-name="Glossy Mug - Black"
                data-item-url="https://qwert3313.github.io/rundless.github.io/mug.html#/">
                ADD TO CART
            </button>        
        </div>
    </div>

    <script>
document.addEventListener("DOMContentLoaded", () => {
    // Farbauswahl und Bildanzeige-Logik
    const form = document.getElementById("code-form");
    const colorSelect = document.getElementById("color-select");
    const slideshows = document.querySelectorAll(".slideshow");
    const buyButton = document.querySelector(".snipcart-add-item"); // Nur ein Button
    let correctCodeEntered = false; // Kann geändert werden
    const colorToIdMap = {
        black: 4657795253,
        darkGreen: 4657795255,
        navy: 4657795254,
        white: 4657795257,
        gray: 4657795256,
    };

    let selectedColor = colorSelect.value; // Standardfarbe beim Laden
    let currentSlideIndex = 0;

    // Standard: Schwarzes Produkt anzeigen
    const defaultSlideshow = document.getElementById("slideshow-black");
    if (defaultSlideshow) {
        defaultSlideshow.style.display = "block";
    }

    // Kauf-Button standardmäßig deaktivieren
    buyButton.style.display = "none";

    // Formular-Event-Listener
    form.addEventListener("submit", async (event) => {
        event.preventDefault(); // Verhindert Standard-Formularabsendung

        const code = document.getElementById("inputField").value.trim();
        let lastChar = code[code.length - 1];

        if (!code) {
            alert("Bitte geben Sie einen gültigen Code ein.");
            return;
        } else if (lastChar != 1) {
            alert("The last digit of the code has to be 1.");
            return;
        }

        try {
            const response = await fetch("https://gamebackend-nfw1.onrender.com/check", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ code }),
            });

            if (response.ok) {
                console.log("OK von Server");

                // Setze correctCodeEntered auf true
                correctCodeEntered = true;

                // Zeige den Kauf-Button für die ausgewählte Farbe
                buyButton.style.display = "block";
                buyButton.setAttribute("data-item-id", colorToIdMap[selectedColor].toString());

                form.style.display = "none"; // Formular ausblenden
            } else {
                alert("Code could not be found on server.");
            }
        } catch (error) {
            console.error("Fehler beim Server-Aufruf:", error);
            alert("Ein Fehler ist aufgetreten. Bitte versuchen Sie es später erneut.");
        }
    });

    // Event-Listener für Farbauswahl
    colorSelect.addEventListener("change", (event) => {
        selectedColor = event.target.value; // Hier wird selectedColor aktualisiert

        // Kauf-Button aktualisieren
        if (correctCodeEntered) {
            buyButton.style.display = "block";
            buyButton.setAttribute("data-item-id", colorToIdMap[selectedColor].toString());
        } else {
            buyButton.style.display = "none";
        }

        // Alle Slideshows ausblenden
        slideshows.forEach((slideshow) => {
            slideshow.style.display = "none";
        });

        // Passende Slideshow anzeigen
        const activeSlideshow = document.getElementById(`slideshow-${selectedColor}`);
        if (activeSlideshow) {
            activeSlideshow.style.display = "block";
            resetSlides(activeSlideshow); // Slides zurücksetzen
        }
    });

    // Funktion zum Wechseln der Bilder
    window.changeSlide = (direction) => {
        const activeSlideshow = document.getElementById(`slideshow-${selectedColor}`);
        if (!activeSlideshow) return;

        const slides = activeSlideshow.querySelectorAll("img");
        slides[currentSlideIndex].classList.remove("active");

        currentSlideIndex = (currentSlideIndex + direction + slides.length) % slides.length;
        slides[currentSlideIndex].classList.add("active");
    };

    // Zurücksetzen der Slides
    function resetSlides(slideshow) {
        const slides = slideshow.querySelectorAll("img");
        slides.forEach((slide) => slide.classList.remove("active"));
        slides[0].classList.add("active"); // Setze erstes Bild aktiv
        currentSlideIndex = 0;
    }
});

// Funktion zum Ändern des Eingabefeld-Typs
function changeType() {
    var inputField = document.getElementById("inputField");
    var button = document.getElementById("button");

    // Ändere den Typ des Eingabefeldes zwischen "password" und "text"
    if (inputField.type === "password") {
        inputField.type = "text";
        button.textContent = "Hide";
    } else {
        inputField.type = "password";
        button.textContent = "View";
    }
}

    </script>
</body>

</html>
